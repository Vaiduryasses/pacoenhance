(paco) liujueqi@amax:~/paco$ CUDA_VISIBLE_DEVICES=1 ./scripts/train_ddp.sh
Using 1 GPUs
Init distributed in rank 0
2025-05-28 18:54:42,456 - PaCo - INFO - Distributed training: True
2025-05-28 18:54:42,456 - PaCo - INFO - Set random seed to 0, deterministic: False
2025-05-28 18:54:42,481 - PaCo - INFO - [DATASET] train set with 12964 samples, batch size: 80, shuffle: True
2025-05-28 18:54:42,487 - PaCo - INFO - [DATASET] test set with 2375 samples, batch size: 80, shuffle: False
2025-05-28 18:54:46,536 - PaCo - INFO - Using Distributed Data parallel ...
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0] Graph break from `Tensor.item()`, consider setting:
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0]     torch._dynamo.config.capture_scalar_outputs = True
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0] or:
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0]     env TORCHDYNAMO_CAPTURE_SCALAR_OUTPUTS=1
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0] to include these operations in the captured graph.
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0] 
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0] Graph break: from user code at:
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0]   File "/data/liujueqi/paco/paco/refinement.py", line 504, in forward
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0]     residual = self.residual_net(points)
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0]   File "/data/liujueqi/paco/paco/refinement.py", line 449, in forward
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0]     chunk_result = MegaBatchProcessor.process_batch_residuals(chunk, self.edge_blocks, self.mlp)
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0]   File "/data/liujueqi/paco/paco/refinement.py", line 288, in process_batch_residuals
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0]     features = block(features, all_points, batch_indices)
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0]   File "/data/liujueqi/paco/paco/refinement.py", line 199, in forward
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0]     return self._approximate_forward(x, pos, batch)
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0]   File "/data/liujueqi/paco/paco/refinement.py", line 225, in _approximate_forward
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0]     edge_index = torch_cluster.knn_graph(sampled_pos, k=4, batch=sampled_batch, loop=False)
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch_cluster/knn.py", line 132, in knn_graph
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0]     edge_index = knn(x, x, k if loop else k + 1, batch, batch, cosine,
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch_cluster/knn.py", line 66, in knn
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0]     batch_size = int(batch_x.max()) + 1
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0] 
[rank0]:W0528 18:55:04.655000 1809708 site-packages/torch/_dynamo/variables/tensor.py:869] [0/0] 
/data/liujueqi/paco/paco/refinement.py:503: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=True):
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] WON'T CONVERT torch_dynamo_resume_in_knn_at_69 /data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch_cluster/knn.py line 69 
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] due to: 
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] Traceback (most recent call last):
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1164, in __call__
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     result = self._inner_convert(
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 547, in __call__
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _compile(
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 986, in _compile
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     guarded_code = compile_inner(code, one_graph, hooks, transform)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 715, in compile_inner
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _compile_inner(code, one_graph, hooks, transform)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_utils_internal.py", line 95, in wrapper_function
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return function(*args, **kwargs)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 750, in _compile_inner
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     out_code = transform_code_object(code, transform)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py", line 1361, in transform_code_object
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     transformations(instructions, code_options)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 231, in _fn
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return fn(*args, **kwargs)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 662, in transform
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     tracer.run()
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2868, in run
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     super().run()
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     while self.step():
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.dispatch_table[inst.opcode](self, inst)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return inner_fn(self, inst)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1658, in CALL_FUNCTION
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.call_function(fn, args, {})
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/torch.py", line 953, in call_function
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     tensor_variable = wrap_fx_proxy(
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2153, in wrap_fx_proxy
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return wrap_fx_proxy_cls(target_cls=TensorVariable, **kwargs)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2219, in wrap_fx_proxy_cls
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _wrap_fx_proxy(
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2315, in _wrap_fx_proxy
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     example_value = get_fake_value(proxy.node, tx, allow_non_graph_fake=True)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2536, in get_fake_value
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     raise TorchRuntimeError(str(e)).with_traceback(e.__traceback__) from None
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2471, in get_fake_value
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     ret_val = wrap_fake_exception(
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2017, in wrap_fake_exception
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return fn()
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2472, in <lambda>
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     lambda: run_node(tx.output, node, args, kwargs, nnmodule)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2604, in run_node
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     raise RuntimeError(make_error_message(e)).with_traceback(
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2586, in run_node
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return node.target(*args, **kwargs)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_ops.py", line 1123, in __call__
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return self._op(*args, **(kwargs or {}))
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] torch._dynamo.exc.TorchRuntimeError: Failed running call_function torch_cluster.knn(*(FakeTensor(..., device='cuda:0', size=(4096, 3), grad_fn=<Error>), FakeTensor(..., device='cuda:0', size=(4096, 3), grad_fn=<Error>), FakeTensor(..., device='cuda:0', size=(17,), dtype=torch.int64), FakeTensor(..., device='cuda:0', size=(17,), dtype=torch.int64), 5, False, 1), **{}):
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] The tensor has a non-zero number of elements, but its data is not allocated yet.
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] If you're using torch.compile/export/fx, it is likely that we are erroneously tracing into a custom kernel. To fix this, please wrap the custom kernel into an opaque custom op. Please see the following for details: https://pytorch.org/tutorials/advanced/custom_ops_landing_page.html
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] If you're using Caffe2, Caffe2 uses a lazy allocation, so you will need to call mutable_data() or raw_mutable_data() to actually allocate memory.
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] from user code:
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]    File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch_cluster/knn.py", line 81, in torch_dynamo_resume_in_knn_at_69
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return torch.ops.torch_cluster.knn(x, y, ptr_x, ptr_y, k, cosine,
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] Traceback (most recent call last):
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1164, in __call__
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     result = self._inner_convert(
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 547, in __call__
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _compile(
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 986, in _compile
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     guarded_code = compile_inner(code, one_graph, hooks, transform)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 715, in compile_inner
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _compile_inner(code, one_graph, hooks, transform)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_utils_internal.py", line 95, in wrapper_function
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return function(*args, **kwargs)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 750, in _compile_inner
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     out_code = transform_code_object(code, transform)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py", line 1361, in transform_code_object
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     transformations(instructions, code_options)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 231, in _fn
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return fn(*args, **kwargs)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 662, in transform
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     tracer.run()
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2868, in run
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     super().run()
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     while self.step():
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.dispatch_table[inst.opcode](self, inst)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return inner_fn(self, inst)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1658, in CALL_FUNCTION
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.call_function(fn, args, {})
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/torch.py", line 953, in call_function
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     tensor_variable = wrap_fx_proxy(
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2153, in wrap_fx_proxy
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return wrap_fx_proxy_cls(target_cls=TensorVariable, **kwargs)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2219, in wrap_fx_proxy_cls
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _wrap_fx_proxy(
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2315, in _wrap_fx_proxy
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     example_value = get_fake_value(proxy.node, tx, allow_non_graph_fake=True)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2536, in get_fake_value
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     raise TorchRuntimeError(str(e)).with_traceback(e.__traceback__) from None
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2471, in get_fake_value
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     ret_val = wrap_fake_exception(
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2017, in wrap_fake_exception
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return fn()
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2472, in <lambda>
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     lambda: run_node(tx.output, node, args, kwargs, nnmodule)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2604, in run_node
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     raise RuntimeError(make_error_message(e)).with_traceback(
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2586, in run_node
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return node.target(*args, **kwargs)
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_ops.py", line 1123, in __call__
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return self._op(*args, **(kwargs or {}))
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] torch._dynamo.exc.TorchRuntimeError: Failed running call_function torch_cluster.knn(*(FakeTensor(..., device='cuda:0', size=(4096, 3), grad_fn=<Error>), FakeTensor(..., device='cuda:0', size=(4096, 3), grad_fn=<Error>), FakeTensor(..., device='cuda:0', size=(17,), dtype=torch.int64), FakeTensor(..., device='cuda:0', size=(17,), dtype=torch.int64), 5, False, 1), **{}):
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] The tensor has a non-zero number of elements, but its data is not allocated yet.
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] If you're using torch.compile/export/fx, it is likely that we are erroneously tracing into a custom kernel. To fix this, please wrap the custom kernel into an opaque custom op. Please see the following for details: https://pytorch.org/tutorials/advanced/custom_ops_landing_page.html
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] If you're using Caffe2, Caffe2 uses a lazy allocation, so you will need to call mutable_data() or raw_mutable_data() to actually allocate memory.
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] from user code:
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]    File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch_cluster/knn.py", line 81, in torch_dynamo_resume_in_knn_at_69
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return torch.ops.torch_cluster.knn(x, y, ptr_x, ptr_y, k, cosine,
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information
[rank0]:W0528 18:55:07.137000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] WON'T CONVERT torch_dynamo_resume_in__approximate_forward_at_225 /data/liujueqi/paco/paco/refinement.py line 225 
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] due to: 
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] Traceback (most recent call last):
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1164, in __call__
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     result = self._inner_convert(
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 547, in __call__
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _compile(
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 986, in _compile
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     guarded_code = compile_inner(code, one_graph, hooks, transform)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 715, in compile_inner
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _compile_inner(code, one_graph, hooks, transform)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_utils_internal.py", line 95, in wrapper_function
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return function(*args, **kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 750, in _compile_inner
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     out_code = transform_code_object(code, transform)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py", line 1361, in transform_code_object
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     transformations(instructions, code_options)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 231, in _fn
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return fn(*args, **kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 662, in transform
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     tracer.run()
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2868, in run
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     super().run()
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     while self.step():
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.dispatch_table[inst.opcode](self, inst)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return inner_fn(self, inst)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1748, in CALL_FUNCTION_KW
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.call_function(fn, args, kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/functions.py", line 317, in call_function
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return super().call_function(tx, args, kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/functions.py", line 118, in call_function
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 903, in inline_user_function_return
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 3072, in inline_call
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return cls.inline_call_(parent, func, args, kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 3198, in inline_call_
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     tracer.run()
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     while self.step():
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.dispatch_table[inst.opcode](self, inst)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return inner_fn(self, inst)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1658, in CALL_FUNCTION
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.call_function(fn, args, {})
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/torch.py", line 953, in call_function
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     tensor_variable = wrap_fx_proxy(
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2153, in wrap_fx_proxy
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return wrap_fx_proxy_cls(target_cls=TensorVariable, **kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2219, in wrap_fx_proxy_cls
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _wrap_fx_proxy(
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2315, in _wrap_fx_proxy
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     example_value = get_fake_value(proxy.node, tx, allow_non_graph_fake=True)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2536, in get_fake_value
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     raise TorchRuntimeError(str(e)).with_traceback(e.__traceback__) from None
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2471, in get_fake_value
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     ret_val = wrap_fake_exception(
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2017, in wrap_fake_exception
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return fn()
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2472, in <lambda>
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     lambda: run_node(tx.output, node, args, kwargs, nnmodule)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2604, in run_node
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     raise RuntimeError(make_error_message(e)).with_traceback(
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2586, in run_node
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return node.target(*args, **kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_ops.py", line 1123, in __call__
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return self._op(*args, **(kwargs or {}))
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] torch._dynamo.exc.TorchRuntimeError: Failed running call_function torch_scatter.scatter_max(*(FakeTensor(..., device='cuda:0', size=(16378, 64), dtype=torch.float16,
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]            grad_fn=<ReluBackward0>), FakeTensor(..., device='cuda:0', size=(16378,), dtype=torch.int64), 0, None, 4096), **{}):
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] The tensor has a non-zero number of elements, but its data is not allocated yet.
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] If you're using torch.compile/export/fx, it is likely that we are erroneously tracing into a custom kernel. To fix this, please wrap the custom kernel into an opaque custom op. Please see the following for details: https://pytorch.org/tutorials/advanced/custom_ops_landing_page.html
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] If you're using Caffe2, Caffe2 uses a lazy allocation, so you will need to call mutable_data() or raw_mutable_data() to actually allocate memory.
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] from user code:
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]    File "/data/liujueqi/paco/paco/refinement.py", line 229, in torch_dynamo_resume_in__approximate_forward_at_225
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     sampled_out, _ = scatter_max(edge_features, edge_index[0], dim=0, dim_size=n_samples)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch_scatter/scatter.py", line 84, in scatter_max
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return torch.ops.torch_scatter.scatter_max(src, index, dim, out, dim_size)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] Traceback (most recent call last):
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1164, in __call__
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     result = self._inner_convert(
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 547, in __call__
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _compile(
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 986, in _compile
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     guarded_code = compile_inner(code, one_graph, hooks, transform)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 715, in compile_inner
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _compile_inner(code, one_graph, hooks, transform)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_utils_internal.py", line 95, in wrapper_function
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return function(*args, **kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 750, in _compile_inner
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     out_code = transform_code_object(code, transform)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py", line 1361, in transform_code_object
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     transformations(instructions, code_options)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 231, in _fn
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return fn(*args, **kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 662, in transform
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     tracer.run()
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2868, in run
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     super().run()
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     while self.step():
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.dispatch_table[inst.opcode](self, inst)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return inner_fn(self, inst)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1748, in CALL_FUNCTION_KW
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.call_function(fn, args, kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/functions.py", line 317, in call_function
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return super().call_function(tx, args, kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/functions.py", line 118, in call_function
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 903, in inline_user_function_return
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 3072, in inline_call
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return cls.inline_call_(parent, func, args, kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 3198, in inline_call_
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     tracer.run()
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     while self.step():
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.dispatch_table[inst.opcode](self, inst)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return inner_fn(self, inst)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1658, in CALL_FUNCTION
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.call_function(fn, args, {})
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/torch.py", line 953, in call_function
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     tensor_variable = wrap_fx_proxy(
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2153, in wrap_fx_proxy
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return wrap_fx_proxy_cls(target_cls=TensorVariable, **kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2219, in wrap_fx_proxy_cls
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _wrap_fx_proxy(
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2315, in _wrap_fx_proxy
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     example_value = get_fake_value(proxy.node, tx, allow_non_graph_fake=True)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2536, in get_fake_value
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     raise TorchRuntimeError(str(e)).with_traceback(e.__traceback__) from None
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2471, in get_fake_value
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     ret_val = wrap_fake_exception(
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2017, in wrap_fake_exception
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return fn()
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2472, in <lambda>
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     lambda: run_node(tx.output, node, args, kwargs, nnmodule)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2604, in run_node
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     raise RuntimeError(make_error_message(e)).with_traceback(
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2586, in run_node
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return node.target(*args, **kwargs)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_ops.py", line 1123, in __call__
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return self._op(*args, **(kwargs or {}))
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] torch._dynamo.exc.TorchRuntimeError: Failed running call_function torch_scatter.scatter_max(*(FakeTensor(..., device='cuda:0', size=(16378, 64), dtype=torch.float16,
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]            grad_fn=<ReluBackward0>), FakeTensor(..., device='cuda:0', size=(16378,), dtype=torch.int64), 0, None, 4096), **{}):
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] The tensor has a non-zero number of elements, but its data is not allocated yet.
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] If you're using torch.compile/export/fx, it is likely that we are erroneously tracing into a custom kernel. To fix this, please wrap the custom kernel into an opaque custom op. Please see the following for details: https://pytorch.org/tutorials/advanced/custom_ops_landing_page.html
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] If you're using Caffe2, Caffe2 uses a lazy allocation, so you will need to call mutable_data() or raw_mutable_data() to actually allocate memory.
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] from user code:
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]    File "/data/liujueqi/paco/paco/refinement.py", line 229, in torch_dynamo_resume_in__approximate_forward_at_225
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     sampled_out, _ = scatter_max(edge_features, edge_index[0], dim=0, dim_size=n_samples)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch_scatter/scatter.py", line 84, in scatter_max
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return torch.ops.torch_scatter.scatter_max(src, index, dim, out, dim_size)
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information
[rank0]:W0528 18:55:07.663000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] WON'T CONVERT scatter_max /data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch_scatter/scatter.py line 78 
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] due to: 
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] Traceback (most recent call last):
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1164, in __call__
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     result = self._inner_convert(
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 547, in __call__
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _compile(
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 986, in _compile
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     guarded_code = compile_inner(code, one_graph, hooks, transform)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 715, in compile_inner
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _compile_inner(code, one_graph, hooks, transform)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_utils_internal.py", line 95, in wrapper_function
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return function(*args, **kwargs)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 750, in _compile_inner
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     out_code = transform_code_object(code, transform)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py", line 1361, in transform_code_object
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     transformations(instructions, code_options)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 231, in _fn
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return fn(*args, **kwargs)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 662, in transform
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     tracer.run()
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2868, in run
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     super().run()
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     while self.step():
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.dispatch_table[inst.opcode](self, inst)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return inner_fn(self, inst)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1658, in CALL_FUNCTION
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.call_function(fn, args, {})
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/torch.py", line 953, in call_function
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     tensor_variable = wrap_fx_proxy(
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2153, in wrap_fx_proxy
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return wrap_fx_proxy_cls(target_cls=TensorVariable, **kwargs)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2219, in wrap_fx_proxy_cls
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _wrap_fx_proxy(
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2315, in _wrap_fx_proxy
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     example_value = get_fake_value(proxy.node, tx, allow_non_graph_fake=True)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2536, in get_fake_value
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     raise TorchRuntimeError(str(e)).with_traceback(e.__traceback__) from None
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2471, in get_fake_value
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     ret_val = wrap_fake_exception(
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2017, in wrap_fake_exception
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return fn()
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2472, in <lambda>
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     lambda: run_node(tx.output, node, args, kwargs, nnmodule)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2604, in run_node
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     raise RuntimeError(make_error_message(e)).with_traceback(
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2586, in run_node
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return node.target(*args, **kwargs)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_ops.py", line 1123, in __call__
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return self._op(*args, **(kwargs or {}))
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] torch._dynamo.exc.TorchRuntimeError: Failed running call_function torch_scatter.scatter_max(*(FakeTensor(..., device='cuda:0', size=(16378, 64), dtype=torch.float16,
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]            grad_fn=<Error>), FakeTensor(..., device='cuda:0', size=(16378,), dtype=torch.int64), 0, None, 4096), **{}):
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] The tensor has a non-zero number of elements, but its data is not allocated yet.
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] If you're using torch.compile/export/fx, it is likely that we are erroneously tracing into a custom kernel. To fix this, please wrap the custom kernel into an opaque custom op. Please see the following for details: https://pytorch.org/tutorials/advanced/custom_ops_landing_page.html
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] If you're using Caffe2, Caffe2 uses a lazy allocation, so you will need to call mutable_data() or raw_mutable_data() to actually allocate memory.
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] from user code:
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]    File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch_scatter/scatter.py", line 84, in scatter_max
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return torch.ops.torch_scatter.scatter_max(src, index, dim, out, dim_size)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] Traceback (most recent call last):
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1164, in __call__
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     result = self._inner_convert(
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 547, in __call__
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _compile(
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 986, in _compile
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     guarded_code = compile_inner(code, one_graph, hooks, transform)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 715, in compile_inner
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _compile_inner(code, one_graph, hooks, transform)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_utils_internal.py", line 95, in wrapper_function
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return function(*args, **kwargs)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 750, in _compile_inner
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     out_code = transform_code_object(code, transform)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py", line 1361, in transform_code_object
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     transformations(instructions, code_options)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 231, in _fn
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return fn(*args, **kwargs)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 662, in transform
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     tracer.run()
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2868, in run
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     super().run()
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     while self.step():
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.dispatch_table[inst.opcode](self, inst)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return inner_fn(self, inst)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1658, in CALL_FUNCTION
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.call_function(fn, args, {})
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/torch.py", line 953, in call_function
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     tensor_variable = wrap_fx_proxy(
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2153, in wrap_fx_proxy
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return wrap_fx_proxy_cls(target_cls=TensorVariable, **kwargs)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2219, in wrap_fx_proxy_cls
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return _wrap_fx_proxy(
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/variables/builder.py", line 2315, in _wrap_fx_proxy
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     example_value = get_fake_value(proxy.node, tx, allow_non_graph_fake=True)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2536, in get_fake_value
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     raise TorchRuntimeError(str(e)).with_traceback(e.__traceback__) from None
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2471, in get_fake_value
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     ret_val = wrap_fake_exception(
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2017, in wrap_fake_exception
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return fn()
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2472, in <lambda>
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     lambda: run_node(tx.output, node, args, kwargs, nnmodule)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2604, in run_node
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     raise RuntimeError(make_error_message(e)).with_traceback(
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_dynamo/utils.py", line 2586, in run_node
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return node.target(*args, **kwargs)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]   File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/_ops.py", line 1123, in __call__
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return self._op(*args, **(kwargs or {}))
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] torch._dynamo.exc.TorchRuntimeError: Failed running call_function torch_scatter.scatter_max(*(FakeTensor(..., device='cuda:0', size=(16378, 64), dtype=torch.float16,
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]            grad_fn=<Error>), FakeTensor(..., device='cuda:0', size=(16378,), dtype=torch.int64), 0, None, 4096), **{}):
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] The tensor has a non-zero number of elements, but its data is not allocated yet.
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] If you're using torch.compile/export/fx, it is likely that we are erroneously tracing into a custom kernel. To fix this, please wrap the custom kernel into an opaque custom op. Please see the following for details: https://pytorch.org/tutorials/advanced/custom_ops_landing_page.html
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] If you're using Caffe2, Caffe2 uses a lazy allocation, so you will need to call mutable_data() or raw_mutable_data() to actually allocate memory.
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] from user code:
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]    File "/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch_scatter/scatter.py", line 84, in scatter_max
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233]     return torch.ops.torch_scatter.scatter_max(src, index, dim, out, dim_size)
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information
[rank0]:W0528 18:55:08.038000 1809708 site-packages/torch/_dynamo/convert_frame.py:1233] 
/data/liujueqi/anaconda3/envs/paco/lib/python3.10/site-packages/torch/nn/_reduction.py:51: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
  warnings.warn(warning.format(ret))